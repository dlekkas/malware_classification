from util import load_obj, save_obj
import pandas as pd
import numpy as np

DATASET_DIR = '/media/dimlek/TOSHIBA EXT/malware/'

def unify_features():
    train_labels = pd.read_csv('~/Documents/thesis/dataset/dataSample/trainLabels.csv')
    
    section_features = load_obj('section_features')
    xref_features = load_obj('xref_features')
    opcode_1gram_features = load_obj('1gram_opcode_tfidf')
    byte_1gram_features = load_obj('1gram_byte_tfidf')

    # concat features with classes and IDs to create the dataset
    data = pd.concat([train_labels, xref_features, section_features, opcode_1gram_features, \
            byte_1gram_features], axis=1, sort=False)
    print(data.shape)    
    save_obj(data, 'interim_data')

    return data


unify_features()

